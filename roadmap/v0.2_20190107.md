# v0.2 2019 week?

MINimal imaGe


## 기능

### 기본 env

USER_HOME \
  docker 이미지별 user home dir

WORK_ROOT \
  설정파일에 있는 application root dir

### 단계별 box 구조

dockerfile 이용해서 빌드
```yaml
cache:
#  grp:
#  usr:
  prj:
    m2: ${USER_HOME}/.m2
    gradle: ${USER_HOME}/.gradle
    npm: ${WORK_ROOT}/app/node_modules
  tmp:
    pass_package: # no default

build:
  arg:
    - IMAGE_NAME=gradle
    - IMAGE_VERSION=5.0.0-jdk8
  dockerfile: MinG.Build.Dockerfile
  after_build: remove # remove(--rm) / preserve (이름지정 ${project_name}-kos_backend
  env:
    - JDK_VERSION=1.8
    - GRADLE_VERSION=5.0
  volume: # - {name}:{mount_path:if not defined use default}
    - m2
    - gradle
    - npm
  exec:
    - copy_in: credential:gradle.properteis:${USER_HOME}/.gradle/gradle.properties
    - work_root: /application
      command:
        - gradle clean
        - gradle yarn
        - gradle build
    - copy_out:
  extract: # 압축해서 꺼내가 ${out파일 이름}:${꺼내갈 파일경로}
    - backend_pkg:/application/app/build/libs/backend.jar

deploy: 
  dockerfile: MinG.Deploy.Dockerfile
  arg:
    - JDK_VERSION=1.8
    - GRADLE_VERSION=5.0
    - APP_VERSION=20190111
  inject: # ADD
    - backend_pkg:/application/app.jar
    - logger_pkg:/logger
  entrypoint: ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/app.jar"]
  push_to:
    docker:
      # default=hub.docker.com
      url: hub.docker.com
      name: scriptonbasestar/deploy_backend:20190111
      # aws
      #url: awssssssssss
      #name: awssssss/deploy_backend:20190111
```
